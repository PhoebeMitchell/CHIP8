#include <iostream>
#include "Memory.h"
#include "Window.h"
#include "Surface.h"

const int WINDOW_WIDTH = 64;
const int WINDOW_HEIGHT = 32;
const std::string WINDOW_NAME = "CHIP8";
const int FONT_SET_START_ADDRESS = 0x50;
const int FONT_SET_SIZE = 80;
const int FONT_SET[] {
        0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
        0x20, 0x60, 0x20, 0x20, 0x70, // 1
        0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
        0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
        0x90, 0x90, 0xF0, 0x10, 0x10, // 4
        0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
        0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
        0xF0, 0x10, 0x20, 0x40, 0x40, // 7
        0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
        0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
        0xF0, 0x90, 0xF0, 0x90, 0x90, // A
        0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
        0xF0, 0x80, 0x80, 0x80, 0xF0, // C
        0xE0, 0x90, 0x90, 0x90, 0xE0, // D
        0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
        0xF0, 0x80, 0xF0, 0x80, 0x80  // F
};

int main() {
    Memory memory;

    // Load font set
    for (auto i = 0; i < FONT_SET_SIZE; i++) {
        memory.SetAddress(FONT_SET_START_ADDRESS + i, FONT_SET[i]);
    }

    Surface surface(WINDOW_WIDTH, WINDOW_HEIGHT, 0, 0, sf::Color::Black, sf::Color::White);
    Window window(WINDOW_WIDTH, WINDOW_HEIGHT, WINDOW_NAME);
    while(window.IsOpen()) {
        window.Clear();
        window.PollEvents();
        surface.DrawToWindow(&window);
        surface.SetPixelActive(10, 10, true);
        window.Display();
    }
}
